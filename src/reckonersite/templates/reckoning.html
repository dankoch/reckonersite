{% extends "base.html" %}

{% block pagetitle %}The Reckoner! - {{ reckoning.question }}{% endblock %}

{% block main %}
    <div id="reckoning-page">
        {% if reckoning.commentary %}
        <div class="commentary-section">
            <div class="profile-picture-wrapper"><img src="{{reckoning.commentary_user.profile_picture_url}}" class="profile-picture"></div>
            <div class="profile-name">{{reckoning.commentary_user.first_name}} {{reckoning.commentary_user.last_name}}</div>
            <div class="commentary-text">{{reckoning.commentary}}</div>
        </div>
        {% endif %}
        
        <div class="question-section">
            <div class="question-wrapper"><h2>{{reckoning.question}}</h2></div> 
            <div class="description-wrapper"><p>{{reckoning.description|safe}}</p></div>           
        </div>
        <div class="voting-section">
            {% include "reckon-two-voting-box.html" %}
        </div>
        <div class="metadata-section">
            <div class="spec-wrapper">
	            <div class="tags-wrapper">
	                <div class="label">Tags:</div>
	                <div class="tags">
	                    {% for tag in reckoning.tags %}
	                        {{tag.tag}}{% if not forloop.last %}, {% endif %}
	                    {% endfor %}
	                </div>
	            </div>
	            <div class="time-wrapper">
	                {% if reckoning.open %}
	                    <div class="label">Remaining Time:</div>
	                    <div class="time">
	                        {{time_remaining.days}} days, {{time_remaining.hours}} hours, {{time_remaining.minutes}} minutes
	                    </div>                    
		            {% else %}
	                    <div class="label">Closing Time:</div>
	                    <div class="time">
	                        {{reckoning.closing_date}}
	                    </div>
		            {% endif %}
	            </div>
            </div>
            <div class="poster-wrapper">
                <div class="profile-picture-wrapper"><img src="{{reckoning.posting_user.profile_picture_url}}" class="profile-picture"></div>
                <div class="label">Posted By:</div>
                <div class="poster-name">{{reckoning.posting_user.first_name}} {{reckoning.posting_user.last_name}}</div>
                <div class="poster-date">{{reckoning.posting_date}}</div>
            </div>
            <div class="bottom-wrapper"></div>
        </div>
    </div>        
{% endblock %}

{% block javascript %}
  {{ block.super }}
  <script type="text/javascript">
  $(document).ready(function(){ 
      var largestHeight = 0;
      
      // The rendering adjustment compensates for how the button 'table-cells' are rendered.
      // Also establishes a minimum size.
      var renderAdjustment = 20;
 
      $('.button-area').find(".reckonbutton > span").each(function() {
          if ($(this).height() > largestHeight) {
            largestHeight = $(this).height();
          }
      });
      
      $('.button-area').find(".reckonbutton > span").each(function() {
          $(this).css('height', largestHeight + renderAdjustment);
      });
  });
  </script>
{% endblock %}
